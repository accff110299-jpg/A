<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ƒêi·ªÉm C√° Nh√¢n - N√¢ng Cao</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .header p {
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .content {
            padding: 30px;
        }

        .mode-select {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .mode-btn {
            padding: 20px;
            border: 2px solid #667eea;
            background: white;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 16px;
            font-weight: 600;
            color: #667eea;
        }

        .mode-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .mode-btn.active {
            background: #667eea;
            color: white;
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 15px 30px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .student-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }

        .student-btn {
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .student-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .result-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .result-card h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
            text-align: center;
        }

        .score-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .score-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .score-item:hover {
            transform: translateY(-5px);
        }

        .score-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        .score-value {
            font-size: 20px;
            font-weight: bold;
            color: #667eea;
        }

        .total-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .total-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .total-item.highlight {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .rank-badge {
            display: inline-block;
            padding: 5px 15px;
            background: #ffd700;
            color: #333;
            border-radius: 20px;
            font-weight: bold;
            margin-top: 10px;
        }

        .filter-section {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            background: #f0f0f0;
            border: 2px solid transparent;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .filter-btn:hover, .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .stats-panel {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        .comparison-chart {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .bar-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .bar-label {
            width: 60px;
            font-size: 12px;
            font-weight: 600;
        }

        .bar-container {
            flex: 1;
            height: 25px;
            background: #f0f0f0;
            border-radius: 15px;
            overflow: hidden;
        }

        .bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            transition: width 0.5s ease-out;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
            color: white;
            font-size: 11px;
            font-weight: bold;
        }

        .hidden {
            display: none;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
            font-size: 18px;
        }

        .error {
            background: #fee;
            color: #c33;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        @media (max-width: 600px) {
            .header h1 {
                font-size: 1.5em;
            }

            .content {
                padding: 20px;
            }

            .score-grid {
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            }

            .total-section {
                grid-template-columns: 1fr;
            }

            .student-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 10;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .achievement-badge {
            display: inline-block;
            padding: 5px 10px;
            background: #ffd700;
            border-radius: 5px;
            font-size: 12px;
            margin: 5px;
            animation: bounce 1s ease-in-out;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéì H·ªá Th·ªëng Tra C·ª©u ƒêi·ªÉm</h1>
            <p>Tra c·ª©u th√¥ng minh - Ph√¢n t√≠ch chi ti·∫øt - So s√°nh tr·ª±c quan</p>
        </div>

        <div class="content">
            <!-- Mode Selection -->
            <div id="modeSection">
                <h3 style="margin-bottom: 15px;">Ch·ªçn ph∆∞∆°ng th·ª©c tra c·ª©u:</h3>
                <div class="mode-select">
                    <button class="mode-btn" onclick="selectMode('buttons')">
                        üìã Danh s√°ch t√™n
                    </button>
                    <button class="mode-btn" onclick="selectMode('manual')">
                        ‚úçÔ∏è Nh·∫≠p th·ªß c√¥ng
                    </button>
                    <button class="mode-btn" onclick="selectMode('advanced')">
                        üîç T√¨m ki·∫øm n√¢ng cao
                    </button>
                </div>
            </div>

            <!-- Button Mode -->
            <div id="buttonMode" class="hidden">
                <button class="btn btn-secondary" onclick="backToMode()">‚Üê Quay l·∫°i</button>
                
                <div class="filter-section" style="margin-top: 15px;">
                    <span style="align-self: center; font-weight: 600;">L·ªçc theo t√™n:</span>
                    <input type="text" id="filterInput" class="search-input" placeholder="G√µ ƒë·ªÉ l·ªçc..." 
                           oninput="filterStudents()" style="flex: 1; min-width: 200px;">
                </div>

                <div id="studentGrid" class="student-grid"></div>
            </div>

            <!-- Manual Mode -->
            <div id="manualMode" class="hidden">
                <button class="btn btn-secondary" onclick="backToMode()">‚Üê Quay l·∫°i</button>
                
                <div class="search-box" style="margin-top: 15px;">
                    <input type="text" id="manualInput" class="search-input" 
                           placeholder="Nh·∫≠p t√™n ho·∫∑c s·ªë th·ª© t·ª± (VD: Nguy·ªÖn VƒÉn A ho·∫∑c 5)"
                           onkeypress="if(event.key === 'Enter') searchManual()">
                    <button class="btn" onclick="searchManual()">üîç Tra c·ª©u</button>
                </div>
            </div>

            <!-- Advanced Mode -->
            <div id="advancedMode" class="hidden">
                <button class="btn btn-secondary" onclick="backToMode()">‚Üê Quay l·∫°i</button>
                
                <div style="margin-top: 20px;">
                    <h4>T√¨m ki·∫øm theo ƒëi·ªÅu ki·ªán:</h4>
                    <div class="filter-section" style="margin-top: 10px;">
                        <button class="filter-btn" onclick="filterByRank('top10')">Top 10</button>
                        <button class="filter-btn" onclick="filterByRank('top20')">Top 20</button>
                        <button class="filter-btn" onclick="filterByScore('high')">ƒêi·ªÉm cao (‚â•8)</button>
                        <button class="filter-btn" onclick="filterByScore('medium')">ƒêi·ªÉm trung b√¨nh (6-8)</button>
                        <button class="filter-btn" onclick="showAll()">T·∫•t c·∫£</button>
                    </div>
                    <div id="advancedResults"></div>
                </div>
            </div>

            <!-- Results -->
            <div id="resultSection" class="hidden">
                <button class="btn btn-secondary" onclick="backToSearch()">‚Üê Tra c·ª©u ti·∫øp</button>
                <div id="resultContainer"></div>
            </div>
        </div>
    </div>

    <script>
        const CSV_FILE_PATH = "data.csv";
        const DISPLAY_HEADERS = [
            "To√°n", "VƒÉn", "Anh", "S·ª≠", "CNTK", "ƒê·ªãa", "KT&PL", "Sinh", "T·ªïng ƒêi·ªÉm", "X·∫øp H·∫°ng"
        ];

        let allData = [];
        let currentMode = '';

        function normalizeString(str) {
            if (!str) return "";
            str = str.toLowerCase();
            str = str.replace(/√°|√†|·∫£|√£|·∫°/g, "a");
            str = str.replace(/√©|√®|·∫ª|·∫Ω|·∫π/g, "e");
            str = str.replace(/√≠|√¨|·ªâ|ƒ©|·ªã/g, "i");
            str = str.replace(/√≥|√≤|·ªè|√µ|·ªç/g, "o");
            str = str.replace(/√∫|√π|·ªß|≈©|·ª•/g, "u");
            str = str.replace(/√Ω|·ª≥|·ª∑|·ªπ|·ªµ/g, "y");
            str = str.replace(/ƒë/g, "d");
            str = str.replace(/[^a-z0-9\s]/g, "");
            str = str.replace(/\s+/g, " ").trim();
            return str;
        }

        async function parseCSV() {
            try {
                const response = await fetch(CSV_FILE_PATH);
                if (!response.ok) {
                    throw new Error("Kh√¥ng th·ªÉ t·∫£i file d·ªØ li·ªáu CSV.");
                }
                const csvText = await response.text();
                const lines = csvText.split('\n').filter(row => row.trim() !== "");
                
                if (lines.length < 2) {
                    throw new Error("File CSV kh√¥ng c√≥ d·ªØ li·ªáu h·ªçc sinh.");
                }
                
                const headers = lines[0].split(',').map(h => h.trim());
                
                allData = lines.slice(1).map((line, index) => {
                    const values = line.split(',').map(v => v.trim());
                    const obj = { index: index + 1 };
                    headers.forEach((header, i) => {
                        obj[header] = values[i];
                    });
                    return obj;
                });
                
                // Load danh s√°ch n√∫t t√™n ngay sau khi parse xong
                loadStudentButtons();
            } catch (error) {
                console.error("L·ªói ƒë·ªçc CSV:", error);
                const grid = document.getElementById('studentGrid');
                if (grid) {
                    grid.innerHTML = `<p style="color: red;">L·ªói t·∫£i d·ªØ li·ªáu: ${error.message}</p>`;
                }
            }
        }

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeSection').classList.add('hidden');
            document.getElementById('buttonMode').classList.add('hidden');
            document.getElementById('manualMode').classList.add('hidden');
            document.getElementById('advancedMode').classList.add('hidden');
            
            if (mode === 'buttons') {
                document.getElementById('buttonMode').classList.remove('hidden');
                loadStudentButtons(); // Load l·∫°i danh s√°ch
            } else if (mode === 'manual') {
                document.getElementById('manualMode').classList.remove('hidden');
            } else if (mode === 'advanced') {
                document.getElementById('advancedMode').classList.remove('hidden');
            }
        }

        function backToMode() {
            document.getElementById('buttonMode').classList.add('hidden');
            document.getElementById('manualMode').classList.add('hidden');
            document.getElementById('advancedMode').classList.add('hidden');
            document.getElementById('resultSection').classList.add('hidden');
            document.getElementById('modeSection').classList.remove('hidden');
        }

        function backToSearch() {
            document.getElementById('resultSection').classList.add('hidden');
            selectMode(currentMode);
        }

        function loadStudentButtons() {
            const grid = document.getElementById('studentGrid');
            
            if (allData.length === 0) {
                grid.innerHTML = '<p style="color: gray;">ƒêang t·∫£i danh s√°ch...</p>';
                return;
            }
            
            grid.innerHTML = allData.map(student => {
                const safeName = student['H·ªç v√† t√™n'].replace(/'/g, "\\'");
                return `<button class="student-btn" onclick="showResultByName('${safeName}')">${student['H·ªç v√† t√™n']}</button>`;
            }).join('');
        }

        function filterStudents() {
            const filter = normalizeString(document.getElementById('filterInput').value);
            const grid = document.getElementById('studentGrid');
            
            if (!filter) {
                loadStudentButtons();
                return;
            }
            
            const filtered = allData.filter(student => 
                normalizeString(student['H·ªç v√† t√™n']).includes(filter)
            );
            
            if (filtered.length === 0) {
                grid.innerHTML = '<p style="color: orange;">Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ ph√π h·ª£p</p>';
                return;
            }
            
            grid.innerHTML = filtered.map(student => {
                const safeName = student['H·ªç v√† t√™n'].replace(/'/g, "\\'");
                return `<button class="student-btn" onclick="showResultByName('${safeName}')">${student['H·ªç v√† t√™n']}</button>`;
            }).join('');
        }

        function searchManual() {
            const input = document.getElementById('manualInput').value.trim();
            if (!input) {
                alert('Vui l√≤ng nh·∫≠p t√™n ho·∫∑c s·ªë th·ª© t·ª±!');
                return;
            }

            let student;
            
            // Ki·ªÉm tra n·∫øu l√† s·ªë th·ª© t·ª± (STT)
            if (!isNaN(parseInt(input)) && isFinite(input)) {
                const sttNumber = parseInt(input);
                const targetIndex = sttNumber - 1;
                
                if (targetIndex >= 0 && targetIndex < allData.length) {
                    student = allData[targetIndex];
                }
            } else {
                // T√¨m theo t√™n
                const normalized = normalizeString(input);
                student = allData.find(s => normalizeString(s['H·ªç v√† t√™n']) === normalized);
            }

            if (student) {
                showResult(student);
            } else {
                alert('üòë Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£. Vui l√≤ng ki·ªÉm tra l·∫°i t√™n ho·∫∑c s·ªë th·ª© t·ª±!');
            }
        }

        function showResultByName(name) {
            const student = allData.find(s => s['H·ªç v√† t√™n'] === name);
            if (student) {
                showResult(student);
            }
        }

        function filterByRank(type) {
            let filtered;
            
            if (type === 'top10') {
                // L·ªçc nh·ªØng ng∆∞·ªùi c√≥ x·∫øp h·∫°ng <= 10
                filtered = allData.filter(s => {
                    const rank = parseInt(s['X·∫øp H·∫°ng']);
                    return !isNaN(rank) && rank <= 10;
                });
            } else if (type === 'top20') {
                // L·ªçc nh·ªØng ng∆∞·ªùi c√≥ x·∫øp h·∫°ng <= 20
                filtered = allData.filter(s => {
                    const rank = parseInt(s['X·∫øp H·∫°ng']);
                    return !isNaN(rank) && rank <= 20;
                });
            }
            
            // S·∫Øp x·∫øp theo x·∫øp h·∫°ng t·ª´ 1 -> 10 ho·∫∑c 1 -> 20
            filtered.sort((a, b) => parseInt(a['X·∫øp H·∫°ng']) - parseInt(b['X·∫øp H·∫°ng']));
            
            displayFilteredResults(filtered);
        }

        function filterByScore(type) {
            let filtered;
            
            if (type === 'high') {
                filtered = allData.filter(s => {
                    const score = parseFloat(s['T·ªïng ƒêi·ªÉm']);
                    return !isNaN(score) && score >= 64;
                });
                // S·∫Øp x·∫øp ƒëi·ªÉm cao xu·ªëng th·∫•p
                filtered.sort((a, b) => parseFloat(b['T·ªïng ƒêi·ªÉm']) - parseFloat(a['T·ªïng ƒêi·ªÉm']));
            } else if (type === 'medium') {
                filtered = allData.filter(s => {
                    const score = parseFloat(s['T·ªïng ƒêi·ªÉm']);
                    return !isNaN(score) && score >= 48 && score < 64;
                });
                // S·∫Øp x·∫øp ƒëi·ªÉm cao xu·ªëng th·∫•p
                filtered.sort((a, b) => parseFloat(b['T·ªïng ƒêi·ªÉm']) - parseFloat(a['T·ªïng ƒêi·ªÉm']));
            }
            
            displayFilteredResults(filtered);
        }

        function showAll() {
            // Hi·ªÉn th·ªã t·∫•t c·∫£, s·∫Øp x·∫øp theo x·∫øp h·∫°ng
            const sorted = [...allData].sort((a, b) => {
                const rankA = parseInt(a['X·∫øp H·∫°ng']);
                const rankB = parseInt(b['X·∫øp H·∫°ng']);
                return rankA - rankB;
            });
            displayFilteredResults(sorted);
        }

        function displayFilteredResults(data) {
            const container = document.getElementById('advancedResults');
            
            if (data.length === 0) {
                container.innerHTML = '<p style="color: orange; text-align: center; margin-top: 20px;">Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ ph√π h·ª£p</p>';
                return;
            }
            
            container.innerHTML = `
                <div style="margin-top: 20px;">
                    <p style="text-align: center; font-weight: 600; margin-bottom: 15px;">T√¨m th·∫•y ${data.length} k·∫øt qu·∫£ (s·∫Øp x·∫øp theo x·∫øp h·∫°ng):</p>
                    <div class="student-grid">
                        ${data.map(student => {
                            const safeName = student['H·ªç v√† t√™n'].replace(/'/g, "\\'");
                            const rank = student['X·∫øp H·∫°ng'];
                            const score = student['T·ªïng ƒêi·ªÉm'];
                            return `<button class="student-btn" onclick="showResultByName('${safeName}')">
                                <div style="font-weight: bold;">#${rank} - ${student['H·ªç v√† t√™n']}</div>
                                <div style="font-size: 11px; margin-top: 5px; opacity: 0.9;">
                                    T·ªïng: ${score} ƒëi·ªÉm
                                </div>
                            </button>`;
                        }).join('')}
                    </div>
                </div>
            `;
        }

        function showResult(student) {
            if (!student) return;

            const subjects = ['To√°n', 'VƒÉn', 'Anh', 'S·ª≠', 'CNTK', 'ƒê·ªãa', 'KT&PL', 'Sinh'];
            const scores = subjects.map(s => parseFloat(student[s]));
            const avgScore = (scores.reduce((a, b) => a + b, 0) / scores.length).toFixed(2);
            const maxScore = Math.max(...scores);
            const minScore = Math.min(...scores);
            
            // T√¨m m√¥n c√≥ ƒëi·ªÉm cao nh·∫•t v√† th·∫•p nh·∫•t
            const maxSubject = subjects[scores.indexOf(maxScore)];
            const minSubject = subjects[scores.indexOf(minScore)];

            const achievements = [];
            const rank = parseInt(student['X·∫øp H·∫°ng']);
            
            // Top 1, 2, 3 ri√™ng bi·ªát
            if (rank === 1) achievements.push('ü•á Top 1');
            else if (rank === 2) achievements.push('ü•à Top 2');
            else if (rank === 3) achievements.push('ü•â Top 3');
            else if (rank >= 4 && rank <= 10) achievements.push('‚≠ê Top 10');
            
            if (parseFloat(student['T·ªïng ƒêi·ªÉm']) >= 70) achievements.push('üéØ Xu·∫•t s·∫Øc');

            document.getElementById('buttonMode').classList.add('hidden');
            document.getElementById('manualMode').classList.add('hidden');
            document.getElementById('advancedMode').classList.add('hidden');
            document.getElementById('resultSection').classList.remove('hidden');

            document.getElementById('resultContainer').innerHTML = `
                <div class="result-card">
                    <h3>üìä K·∫øt qu·∫£ c·ªßa ${student['H·ªç v√† t√™n']}</h3>
                    
                    ${achievements.length > 0 ? `
                        <div style="text-align: center; margin-bottom: 20px;">
                            ${achievements.map(a => `<span class="achievement-badge">${a}</span>`).join('')}
                        </div>
                    ` : ''}

                    <div class="score-grid">
                        ${subjects.map(subject => `
                            <div class="score-item">
                                <div class="score-label">${subject}</div>
                                <div class="score-value">${student[subject]}</div>
                            </div>
                        `).join('')}
                    </div>

                    <div class="total-section">
                        <div class="total-item highlight">
                            <div style="font-size: 14px; margin-bottom: 5px;">T·ªïng ƒëi·ªÉm</div>
                            <div style="font-size: 32px; font-weight: bold;">${student['T·ªïng ƒêi·ªÉm']}</div>
                        </div>
                        <div class="total-item highlight">
                            <div style="font-size: 14px; margin-bottom: 5px;">X·∫øp h·∫°ng</div>
                            <div style="font-size: 32px; font-weight: bold;">#${student['X·∫øp H·∫°ng']}</div>
                        </div>
                    </div>

                    <div class="stats-panel">
                        <h4 style="margin-bottom: 10px;">üìà Th·ªëng k√™ chi ti·∫øt</h4>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value">${avgScore}</div>
                                <div class="stat-label">ƒêi·ªÉm TB</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value">${maxScore}</div>
                                <div class="stat-label">Cao nh·∫•t</div>
                                <div style="font-size: 11px; color: #28a745; font-weight: 600; margin-top: 5px;">${maxSubject}</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value">${minScore}</div>
                                <div class="stat-label">Th·∫•p nh·∫•t</div>
                                <div style="font-size: 11px; color: #dc3545; font-weight: 600; margin-top: 5px;">${minSubject}</div>
                            </div>
                        </div>

                        <div class="comparison-chart">
                            <h4 style="margin-bottom: 15px;">So s√°nh ƒëi·ªÉm c√°c m√¥n</h4>
                            <div class="bar-chart">
                                ${subjects.map(subject => {
                                    const score = parseFloat(student[subject]);
                                    const percent = (score / 10) * 100;
                                    return `
                                        <div class="bar-item">
                                            <div class="bar-label">${subject}</div>
                                            <div class="bar-container">
                                                <div class="bar-fill" style="width: ${percent}%">${score}</div>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Initialize
        window.onload = async function() {
            await parseCSV();
        };
    </script>
</body>
</html>